<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Gestión de Inventario</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

    <div class="container mt-5 mb-5">

        <!-- Encabezado principal -->
        <div class="text-center mb-5">
            <h2 class="fw-bold">Gestión de Inventario</h2>
            <p class="text-muted">Administra las existencias, entradas y salidas del almacén.</p>
            <div class="d-flex justify-content-center gap-3 mt-3">
                <a href="{% url 'inventario:salida' %}" class="btn btn-outline-dark px-4">Registrar Salida</a>
                <a href="{% url 'inventario:entrada' %}" class="btn btn-dark px-4 text-white">Registrar Entrada</a>
                <a href="{% url 'inventario:resumen' %}" class="btn btn-outline-dark px-4">Consultar estado del
                    inventario</a>
            </div>
        </div>

        <!-- Filtros -->
        <div class="card shadow-sm mb-5 border-0">
            <div class="card-body">
                <h5 class="fw-bold text-center mb-3">Filtros</h5>
                <form method="get" class="row g-3 justify-content-center">
                    <div class="col-md-5">
                        {{ form.q }}
                    </div>
                    <div class="col-md-3">
                        {{ form.tipo }}
                    </div>
                    <div class="col-md-3">
                        {{ form.estado }}
                    </div>
                    <div class="col-12 text-center">
                        <button type="submit" class="btn btn-dark px-5">Aplicar filtros</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Resumen -->
        <div class="card shadow-sm border-0 mb-5">
            <div class="card-body text-center">
                <h5 class="fw-bold mb-3">Inventario General</h5>
                <p class="text-muted">Visualiza el estado actual de los productos en inventario.</p>
                <div class="row justify-content-center">
                    <div class="col-md-4">
                        <div class="card bg-light border-0 shadow-sm">
                            <div class="card-body">
                                <h6 class="fw-bold">Productos Totales</h6>
                                <p class="fs-4 fw-semibold text-dark">{{ total_productos }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mt-3 mt-md-0">
                        <div class="card bg-light border-0 shadow-sm">
                            <div class="card-body">
                                <h6 class="fw-bold">Valor Total</h6>
                                <p class="fs-4 fw-semibold text-success">${{ total_valor|floatformat:0 }}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Listado -->
        <div class="card shadow-sm border-0">
            <div class="card-body">
                <h5 class="fw-bold mb-3">Listado de Productos</h5>
                {% if productos %}
                <div class="table-responsive">
                    <table class="table table-hover align-middle">
                        <thead class="table-dark">
                            <tr>
                                <th>Nombre</th>
                                <th>Categoría</th>
                                <th>Precio Unitario</th>
                                <th>Stock</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for producto in productos %}
                            <tr>
                                <td class="fw-semibold">{{ producto.nombre }}</td>
                                <td>{{ producto.categoria }}</td>
                                <td>${{ producto.precio_unitario|floatformat:0 }}</td>
                                <td>
                                    {% if producto.stock <= producto.stock_minimo %} <span class="badge bg-danger">{{
                                        producto.stock }} Bajo stock</span>
                                        {% else %}
                                        <span class="badge bg-success">{{ producto.stock }} Disponible</span>
                                        {% endif %}
                                </td>
                                <td>
                                    <a href="{% url 'inventario:detalle' producto.id %}"
                                        class="btn btn-sm btn-info text-white">Ver</a>
                                    <a href="{% url 'productos:editar' producto.id %}"
                                        class="btn btn-sm btn-warning text-dark">Editar</a>
                                    <a href="{% url 'productos:eliminar' producto.id %}"
                                        class="btn btn-sm btn-danger">Eliminar</a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div class="alert alert-secondary text-center" role="alert">
                    No hay productos registrados.
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>